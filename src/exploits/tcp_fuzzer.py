from socket import *
from Webcrawler import WebCrawler


colors = {
    'BLUE': '\33[1;94m',
    'RED': '\033[1;91m',
    'WHITE': '\33[1;97m',
    'YELLOW': '\33[1;93m',
    'MAGENTA': '\033[1;35m',
    'GREEN': '\033[1;32m',
    'END': '\033[0m',
}


class TCP_Fuzzer(WebCrawler):

    def __init__(self, host, port, base_url="https://google.com"):
        super().__init__(base_url)
        self.host = host
        self.port = port

    def run_fuzzer(self):
        # buffer array
        buffer = ["A"]
        counter = 1000
        while len(buffer) <= 30:
            buffer.append("A" * counter)
            counter += 200

        for bufObj in buffer:
            print("Fuzzing %s: %s with %s bytes" % (self.host, int(self.port), len(bufObj)))
            # IPv4 & TCP connection
            sock = socket(AF_INET, SOCK_STREAM)
            sock.recv(2048)
            # send buffer object with a carriage return and a new line
            sock.send(bufObj+"\r\n")
            sock.close()
